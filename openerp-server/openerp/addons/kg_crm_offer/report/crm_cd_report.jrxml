<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="cd_report" language="groovy" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<subDataset name="dataset1">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
sum((COALESCE((COALESCE(pump.net_amount,0)),0))) as net_amount,
sum(((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)))::integer as basic_cpo_val,
sum((((COALESCE((COALESCE(pump.net_amount,0)),0))/ (case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))::integer as cust_dis_val,

sum((((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when (case when pump.tax = 0 or null then 1 else pump.tax end) = 0 or null then 1 else (case when pump.tax = 0 or null then 1 else pump.tax end) end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))::integer as book_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100))::integer as spl_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))::integer as pf_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))::integer as freight_val,


sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100))::integer as insurance_val,

----------------

((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE((COALESCE(pump.special_discount,0)),0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))) -
sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100)))::integer as dealer_val,

------------------------------
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))) -
sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100))) * avg(pump.dealer_discount) /100)::integer as les_dealer_val,
---------
------------
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))) -
sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100)))::integer -

(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))) -
sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100))) * avg(pump.dealer_discount) /100)::integer)::integer as works_val,

sum(pump.prime_cost)::integer as prime_cost,

ltrim(to_char((COALESCE(((((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))) -
sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100)))::integer -

((((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))) -
sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100))) * avg(pump.dealer_discount) /100)::integer)::integer) /

sum(pump.prime_cost))::numeric, 0.00)),'999G999G99G999G99G99G990D99'))::numeric as ratio,

avg(pump.tax) as avg_basic_cpo,
avg((COALESCE(pump.customer_discount,0))) as avg_cust_dis,
avg((COALESCE(pump.special_discount,0))) as avg_spl_dis,
avg((COALESCE(pump.p_f,0))) as avg_pf_dis,
avg((COALESCE(pump.freight,0))) as avg_freight_dis,
avg(pump.insurance) as avg_ins_dis,
avg(pump.dealer_discount) as avg_deal_dis

from ch_pump_offer pump

where header_id = $P{offer_id}]]>
		</queryString>
		<field name="net_amount" class="java.math.BigDecimal"/>
		<field name="basic_cpo_val" class="java.lang.Integer"/>
		<field name="cust_dis_val" class="java.lang.Integer"/>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="spl_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="freight_val" class="java.lang.Integer"/>
		<field name="insurance_val" class="java.lang.Integer"/>
		<field name="dealer_val" class="java.lang.Integer"/>
		<field name="les_dealer_val" class="java.lang.Integer"/>
		<field name="works_val" class="java.lang.Integer"/>
		<field name="prime_cost" class="java.lang.Integer"/>
		<field name="ratio" class="java.math.BigDecimal"/>
		<field name="avg_basic_cpo" class="java.lang.Double"/>
		<field name="avg_cust_dis" class="java.lang.Double"/>
		<field name="avg_spl_dis" class="java.lang.Double"/>
		<field name="avg_pf_dis" class="java.lang.Double"/>
		<field name="avg_freight_dis" class="java.lang.Double"/>
		<field name="avg_ins_dis" class="java.lang.Double"/>
		<field name="avg_deal_dis" class="java.lang.Double"/>
	</subDataset>
	<subDataset name="dataset2">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
pump.item_name as pump_name,
pump.net_amount as net_amount,
((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end))::integer as basic_cpo_val,
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))::integer as cust_dis_val,

(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))::integer as book_val,
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)::integer as spl_val,
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)::integer as pf_val,
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100)::integer as freight_val,


(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))::integer as book,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100))::integer as pf,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)::integer as ed,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)::integer as tax,

((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100))::integer as tot,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)::integer as insurance_val,

----------------
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100))::integer as dealer_val,

------------------------------

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) * (COALESCE(pump.dealer_discount,0))/100)::integer as les_dealer_val,

---------

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) -

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) * (COALESCE(pump.dealer_discount,0))/100))::integer as works_val,

------------

pump.prime_cost::integer as prime_cost,

ltrim(to_char((COALESCE((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) -

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) * (COALESCE(pump.dealer_discount,0))/100)) /

pump.prime_cost)),'999G999G99G999G99G99G990D99'))::numeric as ratio,

--------

pump.tax as avg_basic_cpo,
pump.customer_discount as avg_cust_dis,
pump.special_discount as avg_spl_dis,
pump.p_f as avg_pf_dis,
pump.freight as avg_freight_dis,
pump.insurance as avg_ins_dis,
pump.dealer_discount as avg_deal_dis

from ch_spare_offer pump

left join kg_pumpmodel_master pumpmas on(pumpmas.id=pump.pump_id)
where header_id =  $P{offer_id}]]>
		</queryString>
		<field name="pump_name" class="java.lang.String"/>
		<field name="net_amount" class="java.math.BigDecimal"/>
		<field name="basic_cpo_val" class="java.lang.Integer"/>
		<field name="cust_dis_val" class="java.lang.Integer"/>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="spl_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="freight_val" class="java.lang.Integer"/>
		<field name="book" class="java.lang.Integer"/>
		<field name="pf" class="java.lang.Integer"/>
		<field name="ed" class="java.lang.Integer"/>
		<field name="tax" class="java.lang.Integer"/>
		<field name="tot" class="java.lang.Integer"/>
		<field name="insurance_val" class="java.lang.Integer"/>
		<field name="dealer_val" class="java.lang.Integer"/>
		<field name="les_dealer_val" class="java.lang.Integer"/>
		<field name="works_val" class="java.lang.Integer"/>
		<field name="prime_cost" class="java.lang.Integer"/>
		<field name="ratio" class="java.math.BigDecimal"/>
		<field name="avg_basic_cpo" class="java.lang.Double"/>
		<field name="avg_cust_dis" class="java.lang.Double"/>
		<field name="avg_spl_dis" class="java.lang.Double"/>
		<field name="avg_pf_dis" class="java.lang.Double"/>
		<field name="avg_freight_dis" class="java.lang.Double"/>
		<field name="avg_ins_dis" class="java.lang.Double"/>
		<field name="avg_deal_dis" class="java.lang.Double"/>
	</subDataset>
	<subDataset name="dataset3">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
access.name as access_name,
pump.net_amount as net_amount,
((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end))::integer as basic_cpo_val,
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))::integer as cust_dis_val,

(((COALESCE(pump.net_amount,0))/(case when (case when pump.tax = 0 or null then 1 else pump.tax end) = 0 or null then 1 else (case when pump.tax = 0 or null then 1 else pump.tax end) end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))::integer as book_val,
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)::integer as spl_val,
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)::integer as pf_val,
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100)::integer as freight_val,


(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))::integer as book,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100))::integer as pf,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)::integer as ed,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)::integer as tax,

((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100))::integer as tot,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)::integer as insurance_val,

----------------
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100))::integer as dealer_val,

------------------------------

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) * (COALESCE(pump.dealer_discount,0))/100)::integer as les_dealer_val,

---------

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) -

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) * (COALESCE(pump.dealer_discount,0))/100))::integer as works_val,

------------

pump.prime_cost::integer as prime_cost,

ltrim(to_char((COALESCE((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) -

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) * (COALESCE(pump.dealer_discount,0))/100)) /

pump.prime_cost)),'999G999G99G999G99G99G990D99'))::numeric as ratio,

--------

pump.tax as avg_basic_cpo,
pump.customer_discount as avg_cust_dis,
pump.special_discount as avg_spl_dis,
pump.p_f as avg_pf_dis,
pump.freight as avg_freight_dis,
pump.insurance as avg_ins_dis,
pump.dealer_discount as avg_deal_dis

from ch_accessories_offer pump

left join kg_accessories_master access on(access.id=pump.access_id)
where header_id = $P{offer_id}
]]>
		</queryString>
		<field name="access_name" class="java.lang.String"/>
		<field name="net_amount" class="java.math.BigDecimal"/>
		<field name="basic_cpo_val" class="java.lang.Integer"/>
		<field name="cust_dis_val" class="java.lang.Integer"/>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="spl_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="freight_val" class="java.lang.Integer"/>
		<field name="book" class="java.lang.Integer"/>
		<field name="pf" class="java.lang.Integer"/>
		<field name="ed" class="java.lang.Integer"/>
		<field name="tax" class="java.lang.Integer"/>
		<field name="tot" class="java.lang.Integer"/>
		<field name="insurance_val" class="java.lang.Integer"/>
		<field name="dealer_val" class="java.lang.Integer"/>
		<field name="les_dealer_val" class="java.lang.Integer"/>
		<field name="works_val" class="java.lang.Integer"/>
		<field name="prime_cost" class="java.lang.Integer"/>
		<field name="ratio" class="java.math.BigDecimal"/>
		<field name="avg_basic_cpo" class="java.lang.Double"/>
		<field name="avg_cust_dis" class="java.lang.Double"/>
		<field name="avg_spl_dis" class="java.lang.Double"/>
		<field name="avg_pf_dis" class="java.lang.Double"/>
		<field name="avg_freight_dis" class="java.lang.Double"/>
		<field name="avg_ins_dis" class="java.lang.Double"/>
		<field name="avg_deal_dis" class="java.lang.Double"/>
	</subDataset>
	<subDataset name="dataset4">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select sum(net_amount) as net_amount,sum(basic_cpo_val) as basic_cpo_val,sum(cust_dis_val) as cust_dis_val,sum(book_val) as book_val,
sum(spl_val) as spl_val,sum(pf_val) as pf_val,sum(freight_val) as freight_val,sum(insurance_val) as insurance_val,sum(dealer_val) as dealer_val,
sum(les_dealer_val) as les_dealer_val,sum(works_val) as works_val,sum(prime_cost) as prime_cost

from

((select
sum((COALESCE((COALESCE(pump.net_amount,0)),0))) as net_amount,
sum(((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)))::integer as basic_cpo_val,
sum((((COALESCE((COALESCE(pump.net_amount,0)),0))/ (case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))::integer as cust_dis_val,

sum((((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when (case when pump.tax = 0 or null then 1 else pump.tax end) = 0 or null then 1 else (case when pump.tax = 0 or null then 1 else pump.tax end) end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))::integer as book_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100))::integer as spl_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))::integer as pf_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))::integer as freight_val,


sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100))::integer as insurance_val,

----------------

((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE((COALESCE(pump.special_discount,0)),0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))) -
sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100)))::integer as dealer_val,

------------------------------
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))) -
sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100))) * avg(pump.dealer_discount) /100)::integer as les_dealer_val,
---------
------------
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))) -
sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100)))::integer -

(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) -
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))) -
sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 1 else pump.tax end)/100))) * pump.insurance/100))) * avg(pump.dealer_discount) /100)::integer)::integer as works_val,

sum(pump.prime_cost)::integer as prime_cost

from ch_pump_offer pump

where header_id = 241)
---------------Spare
union all

(select
sum(pump.net_amount) as net_amount,
sum(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)))::integer as basic_cpo_val,
sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))::integer as cust_dis_val,

sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))::integer as book_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100))::integer as spl_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))::integer as pf_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))::integer as freight_val,

sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100))::integer as insurance_val,

----------------
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)))::integer as dealer_val,

------------------------------

sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) * (COALESCE(pump.dealer_discount,0))/100))::integer as les_dealer_val,

---------

sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) -

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) * (COALESCE(pump.dealer_discount,0))/100)))::integer as works_val,

------------

sum(pump.prime_cost)::integer as prime_cost

--------

from ch_spare_offer pump

left join kg_pumpmodel_master pumpmas on(pumpmas.id=pump.pump_id)
where header_id =  241)

union all
---------------Access

(select
sum(pump.net_amount) as net_amount,
sum(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)))::integer as basic_cpo_val,
sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))::integer as cust_dis_val,

sum((((COALESCE(pump.net_amount,0))/(case when (case when pump.tax = 0 or null then 1 else pump.tax end) = 0 or null then 1 else (case when pump.tax = 0 or null then 1 else pump.tax end) end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))::integer as book_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100))::integer as spl_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))::integer as pf_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100))::integer as freight_val,

sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100))::integer as insurance_val,

----------------
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)))::integer as dealer_val,

------------------------------

sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) * (COALESCE(pump.dealer_discount,0))/100))::integer as les_dealer_val,

---------

sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) -

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE((COALESCE(pump.net_amount,0)),0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0.00))/100)) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * pump.p_f/100))) * (COALESCE(pump.ed,0))/100)) * (COALESCE((case when pump.tax = 0 or null then 1 else pump.tax end),0))/100)) * (COALESCE(pump.insurance,0))/100)) * (COALESCE(pump.dealer_discount,0))/100)))::integer as works_val,

------------

sum(pump.prime_cost)::integer as prime_cost

--------

from ch_accessories_offer pump

left join kg_accessories_master access on(access.id=pump.access_id)
where header_id = 241)) as tot]]>
		</queryString>
		<field name="net_amount" class="java.math.BigDecimal"/>
		<field name="basic_cpo_val" class="java.lang.Long"/>
		<field name="cust_dis_val" class="java.lang.Long"/>
		<field name="book_val" class="java.lang.Long"/>
		<field name="spl_val" class="java.lang.Long"/>
		<field name="pf_val" class="java.lang.Long"/>
		<field name="freight_val" class="java.lang.Long"/>
		<field name="insurance_val" class="java.lang.Long"/>
		<field name="dealer_val" class="java.lang.Long"/>
		<field name="les_dealer_val" class="java.lang.Long"/>
		<field name="works_val" class="java.lang.Long"/>
		<field name="prime_cost" class="java.lang.Long"/>
	</subDataset>
	<subDataset name="dataset5">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))::integer as book_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))::integer as pf_val,

((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100)::integer as ed_val,

(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))) +
(sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) +
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100))) * avg((case when pump.tax = 0 or null then 0 else pump.tax end))/100)::integer as tax,

((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))) +
(sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) +
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100)) +
((((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))) +
(sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) +
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100))) * avg((case when pump.tax = 0 or null then 0 else pump.tax end))/100)))::integer as total,


((sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100))) +
(sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100))))::integer as les_deal_dis,
-----------------

((((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))) +
(sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) +
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100)) +
((((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))) +
(sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) +
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100))) * avg((case when pump.tax = 0 or null then 0 else pump.tax end))/100)))) -
(((sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100))) +
(sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100))))))::integer as nett_sam


from ch_pump_offer pump

where header_id = $P{offer_id}
]]>
		</queryString>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="ed_val" class="java.lang.Integer"/>
		<field name="tax" class="java.lang.Integer"/>
		<field name="total" class="java.lang.Integer"/>
		<field name="les_deal_dis" class="java.lang.Integer"/>
		<field name="nett_sam" class="java.lang.Integer"/>
	</subDataset>
	<subDataset name="dataset6">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
pump.item_name as pump_name,
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))::integer as book_val,
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)::integer as pf_val,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100)::integer as ed_val,

((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100)::integer as tax,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100)) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100)))::integer as total,

((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100)))::integer as les_deal_dis,
-----------------

(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100)) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100)))) -
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100)))))::integer as nett_sam
from ch_spare_offer pump

left join kg_pumpmodel_master pumpmas on(pumpmas.id=pump.pump_id)
where header_id = $P{offer_id}]]>
		</queryString>
		<field name="pump_name" class="java.lang.String"/>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="ed_val" class="java.lang.Integer"/>
		<field name="tax" class="java.lang.Integer"/>
		<field name="total" class="java.lang.Integer"/>
		<field name="les_deal_dis" class="java.lang.Integer"/>
		<field name="nett_sam" class="java.lang.Integer"/>
	</subDataset>
	<subDataset name="dataset7">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
accessmas.name as item_name,
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))::integer as book_val,
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)::integer as pf_val,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100)::integer as ed_val,

((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100)::integer as tax,

(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100)) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100)))::integer as total,

((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100)))::integer as les_deal_dis,
-----------------

(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100)) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100)))) -
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100)))))::integer as nett_sam

from ch_accessories_offer pump

left join kg_accessories_master accessmas on(accessmas.id=pump.access_id)
where header_id = $P{offer_id}]]>
		</queryString>
		<field name="item_name" class="java.lang.String"/>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="ed_val" class="java.lang.Integer"/>
		<field name="tax" class="java.lang.Integer"/>
		<field name="total" class="java.lang.Integer"/>
		<field name="les_deal_dis" class="java.lang.Integer"/>
		<field name="nett_sam" class="java.lang.Integer"/>
	</subDataset>
	<subDataset name="dataset8">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select sum(book_val) as book_val,sum(pf_val) as pf_val,sum(ed_val) as ed_val,sum(tax) as tax,sum(total) as total,
sum(les_deal_dis) as les_deal_dis,sum(nett_sam) as nett_sam from
((select
sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))::integer as book_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))::integer as pf_val,

((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100)::integer as ed_val,

(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))) +
(sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) +
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100))) * avg((case when pump.tax = 0 or null then 0 else pump.tax end))/100)::integer as tax,

((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))) +
(sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) +
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100)) +
((((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))) +
(sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) +
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100))) * avg((case when pump.tax = 0 or null then 0 else pump.tax end))/100)))::integer as total,


((sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100))) +
(sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100))))::integer as les_deal_dis,
-----------------

((((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))) +
(sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) +
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100)) +
((((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))) +
(sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) +
(((sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * avg((COALESCE(pump.ed,0)))/100))) * avg((case when pump.tax = 0 or null then 0 else pump.tax end))/100)))) -
(((sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100))) +
(sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100))))))::integer as nett_sam


from ch_pump_offer pump

where header_id = $P{offer_id})

--------------Spare
union all

(select
sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))::integer as book_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))::integer as pf_val,

sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))::integer as ed_val,

sum(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))::integer as tax,

sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100)) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))))::integer as total,

sum(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100))))::integer as les_deal_dis,
-----------------

sum((((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100)) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100)))) -
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100))))))::integer as nett_sam

from ch_spare_offer pump

left join kg_pumpmodel_master pumpmas on(pumpmas.id=pump.pump_id)
where header_id = $P{offer_id})
---------------Access
union all

(select
sum((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))))::integer as book_val,
sum(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))::integer as pf_val,

sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))::integer as ed_val,

sum(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))::integer as tax,

sum((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100)) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))))::integer as total,

sum(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100))))::integer as les_deal_dis,
-----------------

sum((((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100)) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100)) * (COALESCE(pump.ed,0))/100))) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100)))) -
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.special_discount,0))/100)) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) -
(((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) -
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.freight,0))/100) -
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100))) +
((((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) +
((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100)))) +
(((((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) - (((COALESCE(pump.net_amount,0))/(case when pump.tax = 0 or null then 1 else pump.tax end)) * ((COALESCE(pump.customer_discount,0))/100))) * (COALESCE(pump.p_f,0))/100))) * ((COALESCE(pump.ed,0))/100)) * (case when pump.tax = 0 or null then 0 else pump.tax end)/100))) * pump.insurance/100)) * pump.dealer_discount /100))))))::integer as nett_sam

from ch_accessories_offer pump

left join kg_accessories_master accessmas on(accessmas.id=pump.access_id)
where header_id = $P{offer_id})) as ttaota]]>
		</queryString>
		<field name="book_val" class="java.lang.Long"/>
		<field name="pf_val" class="java.lang.Long"/>
		<field name="ed_val" class="java.lang.Long"/>
		<field name="tax" class="java.lang.Long"/>
		<field name="total" class="java.lang.Long"/>
		<field name="les_deal_dis" class="java.lang.Long"/>
		<field name="nett_sam" class="java.lang.Long"/>
	</subDataset>
	<parameter name="offer_id" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[select off.name as off_no,
comp.name as company,

(CASE WHEN comppart.street is null
THEN ''
ELSE comppart.street
end ) as comp_street,
(CASE WHEN comppart.street2 is null
THEN ''
ELSE comppart.street2
end ) as comp_street2,
(CASE WHEN compcity.name is null
THEN ''
ELSE compcity.name
end ) as comp_city,
(CASE WHEN compstate.name is null
THEN ''
ELSE compstate.name
end ) as comp_state,
(CASE WHEN comppart.zip is null
THEN ''
ELSE comppart.zip
end ) as comp_zip,

partner.name as customer,
to_char(off.offer_date, 'dd/mm/yyyy') as offer_date,
to_char(off.del_date, 'dd/mm/yyyy') as del_date,
(CASE WHEN off.l_d_clause = '5_1' THEN '0.5 - 1.0% of total order value'
WHEN off.l_d_clause = '1_10' THEN '1 - 10% of total order value'
WHEN off.l_d_clause is null THEN ''
ELSE off.l_d_clause
end) as penality

from kg_crm_offer off

left join res_partner partner on(partner.id=off.customer_id)
left join res_company comp on(comp.id=off.company_id)
left join res_partner comppart on(comppart.id=comp.partner_id)
left join res_city compcity on(compcity.id=comppart.city_id)
left join res_country_state compstate on(compstate.id=comppart.state_id)

where off.id = $P{offer_id}]]>
	</queryString>
	<field name="off_no" class="java.lang.String"/>
	<field name="company" class="java.lang.String"/>
	<field name="comp_street" class="java.lang.String"/>
	<field name="comp_street2" class="java.lang.String"/>
	<field name="comp_city" class="java.lang.String"/>
	<field name="comp_state" class="java.lang.String"/>
	<field name="comp_zip" class="java.lang.String"/>
	<field name="customer" class="java.lang.String"/>
	<field name="offer_date" class="java.lang.String"/>
	<field name="del_date" class="java.lang.String"/>
	<field name="penality" class="java.lang.String"/>
	<group name="Pump_detail">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="15">
				<componentElement>
					<reportElement x="48" y="0" width="765" height="14"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset1">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="765">
							<textField isBlankWhenNull="true">
								<reportElement x="80" y="0" width="47" height="14"/>
								<box topPadding="2" leftPadding="0" rightPadding="2">
									<topPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{net_amount}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="146" y="0" width="43" height="14"/>
								<box topPadding="2" leftPadding="0" bottomPadding="0" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{basic_cpo_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="208" y="0" width="38" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{cust_dis_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="246" y="0" width="46" height="14"/>
								<box topPadding="2" leftPadding="0" rightPadding="1">
									<topPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="311" y="0" width="36" height="14"/>
								<box topPadding="2" leftPadding="0" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{spl_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="366" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="417" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="468" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{insurance_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="502" y="0" width="50" height="14"/>
								<box topPadding="2" leftPadding="0" rightPadding="2">
									<topPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="579" y="0" width="48" height="14"/>
								<box topPadding="2" leftPadding="0" rightPadding="2">
									<topPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="627" y="0" width="48" height="14"/>
								<box topPadding="2" leftPadding="0" rightPadding="2">
									<topPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{works_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="127" y="0" width="19" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_basic_cpo}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="189" y="0" width="19" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_cust_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="292" y="0" width="19" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_spl_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="347" y="0" width="19" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_pf_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="400" y="0" width="17" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_freight_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="451" y="0" width="17" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_ins_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="552" y="0" width="27" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_deal_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="675" y="0" width="48" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{prime_cost}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="723" y="0" width="42" height="14"/>
								<box topPadding="2" rightPadding="0">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ratio}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
				<textField>
					<reportElement x="-12" y="0" width="140" height="14"/>
					<box topPadding="2" leftPadding="2">
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center">
						<font size="10"/>
					</textElement>
					<textFieldExpression><![CDATA["Pump"]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="Spare_detail">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset2">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pump_name}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="47" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{net_amount}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="187" y="0" width="19" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_basic_cpo}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="206" y="0" width="43" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{basic_cpo_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="249" y="0" width="19" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_cust_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="268" y="0" width="38" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{cust_dis_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="306" y="0" width="46" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="352" y="0" width="19" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_spl_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="371" y="0" width="36" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{spl_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="407" y="0" width="19" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_pf_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="426" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="460" y="0" width="17" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_freight_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="477" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="511" y="0" width="17" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_ins_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="528" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{insurance_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="562" y="0" width="50" height="14"/>
								<box topPadding="2" rightPadding="2">
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="612" y="0" width="27" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_deal_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="639" y="0" width="48" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="687" y="0" width="48" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{works_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="735" y="0" width="48" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{prime_cost}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="783" y="0" width="42" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ratio}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Access_detail">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset3">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField>
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{access_name}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="206" y="0" width="43" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{basic_cpo_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="47" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{net_amount}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="187" y="0" width="19" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_basic_cpo}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="249" y="0" width="19" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_cust_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="268" y="0" width="38" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{cust_dis_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="306" y="0" width="46" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="352" y="0" width="19" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_spl_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="371" y="0" width="36" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{spl_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="407" y="0" width="19" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_pf_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="426" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="460" y="0" width="17" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_freight_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="477" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="511" y="0" width="17" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_ins_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="528" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{insurance_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="562" y="0" width="50" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="612" y="0" width="27" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_deal_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="639" y="0" width="48" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="687" y="0" width="48" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{works_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="735" y="0" width="48" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{prime_cost}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="783" y="0" width="42" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ratio}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Supervision_detail">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="15">
				<componentElement>
					<reportElement x="48" y="0" width="765" height="15"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset4">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="15" width="765">
							<textField isBlankWhenNull="true">
								<reportElement x="80" y="0" width="47" height="15"/>
								<box topPadding="2" rightPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{net_amount}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="189" y="0" width="57" height="15"/>
								<box topPadding="2" rightPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{cust_dis_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="246" y="0" width="46" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="292" y="0" width="55" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{spl_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="347" y="0" width="53" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="400" y="0" width="51" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="451" y="0" width="51" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{insurance_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="502" y="0" width="50" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="579" y="0" width="48" height="15"/>
								<box topPadding="2" rightPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="627" y="0" width="48" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{works_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="675" y="0" width="48" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{prime_cost}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
				<textField>
					<reportElement x="-12" y="0" width="140" height="15"/>
					<box topPadding="2">
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="175" y="0" width="62" height="15"/>
					<box>
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[""]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="600" y="0" width="27" height="15"/>
					<box>
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[""]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="771" y="0" width="42" height="15"/>
					<box>
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[""]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="Child_detail">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="48">
				<textField>
					<reportElement x="-12" y="17" width="140" height="17"/>
					<box topPadding="2" leftPadding="2">
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement/>
					<textFieldExpression><![CDATA["Description"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="128" y="17" width="154" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["Basic Value (Book Value)"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="282" y="17" width="34" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["P&F"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="316" y="17" width="46" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["ED"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="362" y="17" width="50" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["Tax"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="412" y="17" width="87" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["Total"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="-12" y="0" width="424" height="17"/>
					<box topPadding="2">
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["SAM Invoice Details"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="412" y="0" width="401" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["Original of CPO is enclosed"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="499" y="17" width="224" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["Less (Dealer Cr.Note + Special Discount)"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="723" y="17" width="90" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["Nett To SAM"]]></textFieldExpression>
				</textField>
				<componentElement>
					<reportElement x="48" y="34" width="765" height="14"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset5">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="765">
							<textField isBlankWhenNull="true">
								<reportElement x="80" y="0" width="154" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="234" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="268" y="0" width="46" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ed_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="314" y="0" width="50" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{tax}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="364" y="0" width="87" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="451" y="0" width="224" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_deal_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="675" y="0" width="90" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{nett_sam}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
				<textField>
					<reportElement x="-12" y="34" width="140" height="14"/>
					<box topPadding="2">
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center">
						<font size="10"/>
					</textElement>
					<textFieldExpression><![CDATA["Pump"]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="Child_spare">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset6">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pump_name}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="154" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="294" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="328" y="0" width="46" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ed_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="374" y="0" width="50" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{tax}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="424" y="0" width="87" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="511" y="0" width="224" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_deal_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="735" y="0" width="90" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{nett_sam}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Child_access">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset7">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{item_name}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="154" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="294" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="328" y="0" width="46" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ed_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="374" y="0" width="50" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{tax}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="424" y="0" width="87" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="511" y="0" width="224" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_deal_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="735" y="0" width="90" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{nett_sam}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Child_Supervision">
		<groupExpression><![CDATA[$F{off_no}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="128" y="0" width="685" height="14"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset8">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="685">
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="154" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="154" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="188" y="0" width="46" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ed_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="234" y="0" width="50" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{tax}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="284" y="0" width="87" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="371" y="0" width="224" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_deal_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="595" y="0" width="90" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{nett_sam}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
				<textField>
					<reportElement x="-12" y="0" width="140" height="14"/>
					<box topPadding="2">
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL"]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="88" splitType="Stretch">
			<textField>
				<reportElement x="168" y="0" width="448" height="24"/>
				<box topPadding="4"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{company}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="-12" y="40" width="428" height="16"/>
				<box topPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["COMMERCIAL DETAILS"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="416" y="40" width="33" height="16"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Ref : "]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="672" y="40" width="141" height="16"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Expected Delivery Date"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="-12" y="56" width="82" height="16"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["CUSTOMER : "]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="-12" y="72" width="278" height="16"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Delivery as per C.P.O - 16 Weeks"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="266" y="72" width="284" height="16"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Delivery consider by SAM - 16 Weeks"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="550" y="72" width="66" height="16"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Penalty"]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="70" y="56" width="346" height="16"/>
				<box topPadding="2">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA[$F{customer}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="449" y="40" width="223" height="16"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA[$F{off_no}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="416" y="56" width="33" height="16"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Date: "]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="449" y="56" width="223" height="16"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA[$F{offer_date}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="672" y="56" width="141" height="16"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA[$F{del_date}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="48" y="24" width="708" height="14"/>
				<textElement textAlignment="Center"/>
				<textFieldExpression><![CDATA[$F{comp_street}+$F{comp_street2}+$F{comp_city}+$F{comp_state}+'-'+$F{comp_zip}]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="-12" y="0" width="47" height="40"/>
				<imageExpression><![CDATA["/OpenERP/Sam_Turbo/openerp-foundry/openerp-server/openerp/addons/kg_crm_offer/img/sam.png"]]></imageExpression>
			</image>
			<textField isBlankWhenNull="true">
				<reportElement x="616" y="72" width="197" height="16"/>
				<box topPadding="4" leftPadding="2" rightPadding="0">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{penality}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<columnHeader>
		<band height="16" splitType="Stretch">
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="-12" y="0" width="140" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Description"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="128" y="0" width="47" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["CPO value"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="340" y="0" width="55" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Less special Discount(2)"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="294" y="0" width="46" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Book Value(1)"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="237" y="0" width="57" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Less Cust.Discount"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="448" y="0" width="51" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Freight Paid"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="395" y="0" width="53" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["P&F"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="771" y="0" width="42" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Ratio"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="675" y="0" width="48" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Works Value"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="499" y="0" width="51" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Insurance"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="723" y="0" width="48" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Prime Cost"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="600" y="0" width="75" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Less: Dealer's Discount"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="175" y="0" width="62" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Basic CPO Value after Deducting the Tax"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="550" y="0" width="50" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Value considered for Dealer Discount"]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<pageFooter>
		<band height="13">
			<textField evaluationTime="Report">
				<reportElement x="370" y="0" width="129" height="13"/>
				<box topPadding="2" leftPadding="0">
					<topPen lineWidth="0.0"/>
				</box>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="290" y="0" width="80" height="13"/>
				<box topPadding="2" leftPadding="0">
					<topPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<lastPageFooter>
		<band height="39">
			<textField>
				<reportElement x="59" y="25" width="132" height="14"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["REGIONAL HEAD"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="333" y="25" width="132" height="14"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["DIVISION HEAD"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="600" y="25" width="132" height="14"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["MD"]]></textFieldExpression>
			</textField>
		</band>
	</lastPageFooter>
</jasperReport>
