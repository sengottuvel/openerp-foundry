<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="cd_report" language="groovy" pageWidth="842" pageHeight="595" orientation="Landscape" whenNoDataType="NoDataSection" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.1000000000000008"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="48"/>
	<subDataset name="dataset1">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
sum((COALESCE((COALESCE(pump.net_amount,0)),0))) as net_amount,
-- Cust Dis val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer as cust_dis_val,
-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer as book_val,
-- Spl val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer as spl_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer pf_val,

-- Freight val
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val,

-- Dealer val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer as dealer_val,
-- Agent Com val
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer as agent_com_val,
-- Works val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -

((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as works_val,

-- Primecost val
sum(pump.prime_cost)::integer as prime_cost,

-- Ratio val
ltrim(to_char((COALESCE((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -

((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer

/

sum(pump.prime_cost)::numeric, 0.00)),'999G999G99G999G99G99G990D99')) as ratio,

avg((COALESCE(pump.customer_discount,0))) as avg_cust_dis,
avg((COALESCE(pump.special_discount,0))) as avg_spl_dis,
avg((COALESCE(pump.p_f,0))) as avg_pf_dis,
avg((COALESCE(pump.freight,0))) as avg_freight_dis,
avg((COALESCE(pump.dealer_discount,0))) as avg_deal_dis,
avg((COALESCE(pump.agent_com,0))) as avg_agent_dis

from ch_pump_offer pump

where header_id = $P{offer_id}

group by pump.insurance_in_ex]]>
		</queryString>
		<field name="net_amount" class="java.math.BigDecimal"/>
		<field name="cust_dis_val" class="java.lang.Integer"/>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="spl_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="freight_val" class="java.lang.Integer"/>
		<field name="dealer_val" class="java.lang.Integer"/>
		<field name="agent_com_val" class="java.lang.Integer"/>
		<field name="works_val" class="java.lang.Integer"/>
		<field name="prime_cost" class="java.lang.Integer"/>
		<field name="ratio" class="java.lang.String"/>
		<field name="avg_cust_dis" class="java.lang.Double"/>
		<field name="avg_spl_dis" class="java.lang.Double"/>
		<field name="avg_pf_dis" class="java.lang.Double"/>
		<field name="avg_freight_dis" class="java.lang.Double"/>
		<field name="avg_deal_dis" class="java.lang.Double"/>
		<field name="avg_agent_dis" class="java.lang.Double"/>
	</subDataset>
	<subDataset name="dataset2">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
sum((COALESCE((COALESCE(pump.net_amount,0)),0))) as net_amount,
-- Cust Dis val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer as cust_dis_val,
-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer as book_val,
-- Spl val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer as spl_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer pf_val,

-- Freight val
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val,

-- Dealer val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer as dealer_val,
-- Agent Com val
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer as agent_com_val,
-- Works val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -

((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as works_val,

-- Primecost val
sum(pump.prime_cost)::integer as prime_cost,

-- Ratio val
ltrim(to_char((COALESCE((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -

((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer

/

sum(pump.prime_cost)::numeric, 0.00)),'999G999G99G999G99G99G990D99')) as ratio,

avg((COALESCE(pump.customer_discount,0))) as avg_cust_dis,
avg((COALESCE(pump.special_discount,0))) as avg_spl_dis,
avg((COALESCE(pump.p_f,0))) as avg_pf_dis,
avg((COALESCE(pump.freight,0))) as avg_freight_dis,
avg((COALESCE(pump.dealer_discount,0))) as avg_deal_dis,
avg((COALESCE(pump.agent_com,0))) as avg_agent_dis

from ch_spare_offer pump

where header_id = $P{offer_id}

group by pump.insurance_in_ex]]>
		</queryString>
		<field name="net_amount" class="java.math.BigDecimal"/>
		<field name="cust_dis_val" class="java.lang.Integer"/>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="spl_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="freight_val" class="java.lang.Integer"/>
		<field name="dealer_val" class="java.lang.Integer"/>
		<field name="agent_com_val" class="java.lang.Integer"/>
		<field name="works_val" class="java.lang.Integer"/>
		<field name="prime_cost" class="java.lang.Integer"/>
		<field name="ratio" class="java.lang.String"/>
		<field name="avg_cust_dis" class="java.lang.Double"/>
		<field name="avg_spl_dis" class="java.lang.Double"/>
		<field name="avg_pf_dis" class="java.lang.Double"/>
		<field name="avg_freight_dis" class="java.lang.Double"/>
		<field name="avg_deal_dis" class="java.lang.Double"/>
		<field name="avg_agent_dis" class="java.lang.Double"/>
	</subDataset>
	<subDataset name="dataset3">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
sum((COALESCE((COALESCE(pump.net_amount,0)),0))) as net_amount,

-- Cust Dis val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer as cust_dis_val,
-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) as book_val,
-- Spl val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer as spl_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer pf_val,

-- Freight val
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val,

-- Dealer val

((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer as dealer_val,

-- Les Dealer val
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer as agent_com_val,
-- Works val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as works_val,
-- Primecost val
sum(pump.prime_cost)::integer as prime_cost,

-- Ratio val
ltrim(to_char((COALESCE((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer

/

sum(pump.prime_cost)::numeric, 0.00)),'999G999G99G999G99G99G990D99')) as ratio,

avg(pump.tax) as avg_basic_cpo,
avg((COALESCE(pump.customer_discount,0))) as avg_cust_dis,
avg((COALESCE(pump.special_discount,0))) as avg_spl_dis,
avg((COALESCE(pump.p_f,0))) as avg_pf_dis,
avg((COALESCE(pump.freight,0))) as avg_freight_dis,
avg((COALESCE(pump.dealer_discount,0))) as avg_deal_dis,
avg((COALESCE(pump.dealer_discount,0))) as avg_agent_dis
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.insurance_in_ex]]>
		</queryString>
		<field name="net_amount" class="java.math.BigDecimal"/>
		<field name="cust_dis_val" class="java.lang.Integer"/>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="spl_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="freight_val" class="java.lang.Integer"/>
		<field name="dealer_val" class="java.lang.Integer"/>
		<field name="agent_com_val" class="java.lang.Integer"/>
		<field name="works_val" class="java.lang.Integer"/>
		<field name="prime_cost" class="java.lang.Integer"/>
		<field name="ratio" class="java.lang.String"/>
		<field name="avg_basic_cpo" class="java.lang.Double"/>
		<field name="avg_cust_dis" class="java.lang.Double"/>
		<field name="avg_spl_dis" class="java.lang.Double"/>
		<field name="avg_pf_dis" class="java.lang.Double"/>
		<field name="avg_freight_dis" class="java.lang.Double"/>
		<field name="avg_deal_dis" class="java.lang.Double"/>
		<field name="avg_agent_dis" class="java.lang.Double"/>
	</subDataset>
	<subDataset name="dataset4">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select sum(net_amount) as net_amount,sum(cust_dis_val) as cust_dis_val,sum(book_val) as book_val,
sum(spl_val) as spl_val,sum(pf_val) as pf_val,sum(freight_val) as freight_val,sum(dealer_val) as dealer_val,
sum(agent_com_val) as agent_com_val,sum(works_val) as works_val,sum(prime_cost) as prime_cost

from

((select
sum((COALESCE((COALESCE(pump.net_amount,0)),0))) as net_amount,
-- Cust Dis val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer as cust_dis_val,
-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer as book_val,
-- Spl val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer as spl_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer pf_val,

-- Freight val
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val,

-- Dealer val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer as dealer_val,
-- Agent Com val
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer as agent_com_val,
-- Works val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -

((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as works_val,

-- Primecost val
sum(pump.prime_cost)::integer as prime_cost,

avg((COALESCE(pump.customer_discount,0))) as avg_cust_dis,
avg((COALESCE(pump.special_discount,0))) as avg_spl_dis,
avg((COALESCE(pump.p_f,0))) as avg_pf_dis,
avg((COALESCE(pump.freight,0))) as avg_freight_dis,
avg((COALESCE(pump.dealer_discount,0))) as avg_deal_dis,
avg((COALESCE(pump.agent_com,0))) as avg_agent_dis

from ch_pump_offer pump

where header_id = $P{offer_id}

group by pump.insurance_in_ex)



---------------Spare
union all

(select
sum((COALESCE((COALESCE(pump.net_amount,0)),0))) as net_amount,
-- Cust Dis val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer as cust_dis_val,
-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer as book_val,
-- Spl val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer as spl_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer pf_val,

-- Freight val
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val,

-- Dealer val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer as dealer_val,
-- Agent Com val
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer as agent_com_val,
-- Works val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -

((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as works_val,

-- Primecost val
sum(pump.prime_cost)::integer as prime_cost,

avg((COALESCE(pump.customer_discount,0))) as avg_cust_dis,
avg((COALESCE(pump.special_discount,0))) as avg_spl_dis,
avg((COALESCE(pump.p_f,0))) as avg_pf_dis,
avg((COALESCE(pump.freight,0))) as avg_freight_dis,
avg((COALESCE(pump.dealer_discount,0))) as avg_deal_dis,
avg((COALESCE(pump.agent_com,0))) as avg_agent_dis

from ch_spare_offer pump

where header_id = $P{offer_id}

group by pump.insurance_in_ex)

union all
---------------Access

(select
sum((COALESCE((COALESCE(pump.net_amount,0)),0))) as net_amount,

-- Cust Dis val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer as cust_dis_val,
-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) as book_val,
-- Spl val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer as spl_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer pf_val,

-- Freight val
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val,

-- Dealer val

((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer as dealer_val,

-- Les Dealer val
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer as agent_com_val,
-- Works val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as works_val,
-- Primecost val
sum(pump.prime_cost)::integer as prime_cost,

avg((COALESCE(pump.customer_discount,0))) as avg_cust_dis,
avg((COALESCE(pump.special_discount,0))) as avg_spl_dis,
avg((COALESCE(pump.p_f,0))) as avg_pf_dis,
avg((COALESCE(pump.freight,0))) as avg_freight_dis,
avg((COALESCE(pump.dealer_discount,0))) as avg_deal_dis,
avg((COALESCE(pump.dealer_discount,0))) as avg_agent_dis
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.insurance_in_ex)

union all

(select

sum((COALESCE(pump.net_amount,0))) as net_amount,

-- Cust Dis val
sum((((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer) as cust_dis_val,

-- Book val
sum(((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer) as book_val,

-- Spl val
sum(((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer) as spl_val,

-- PF val
sum(((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer) as pf_val,

-- Freight val
sum(((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer) as freight_val,

-- Dealer val
sum(((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer) as dealer_val,

-- Less Dealer Val
sum(((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer*
(COALESCE(pump.agent_com ,0)))/100)::integer) as agent_com_val,

-- Works Val
sum(((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer*
(COALESCE(pump.dealer_discount ,0)))/100)::integer) as works_val,

--Primecost val
sum((COALESCE(pump.prime_cost ,0))) as prime_cost,

avg((COALESCE(pump.customer_discount,0))) as avg_cust_dis,
avg((COALESCE(pump.special_discount,0))) as avg_spl_dis,
avg((COALESCE(pump.p_f,0))) as avg_pf_dis,
avg((COALESCE(pump.freight,0))) as avg_freight_dis,
avg((COALESCE(pump.dealer_discount,0))) as avg_deal_dis,
avg((COALESCE(pump.dealer_discount,0))) as avg_agent_dis

from ch_accessories_offer pump

left join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag != True)

-----------Freight
union all

(select sum(freight_val)::integer as net_amount,0,sum(freight_val)::integer as book_val,0,0,0,0,0,0,0,0,0,0,0,0,0
from(

-- Pump Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.insurance_in_ex

union

-- Spare Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.insurance_in_ex

union

-- Access Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val

union

-- Access False Freight val
select
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer as freight_val

from ch_accessories_offer pump

left join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and (access.is_pump_acc_flag != True or access.is_pump_acc_flag is null)

)as tot
)


)as tot]]>
		</queryString>
		<field name="net_amount" class="java.math.BigDecimal"/>
		<field name="cust_dis_val" class="java.math.BigDecimal"/>
		<field name="book_val" class="java.math.BigDecimal"/>
		<field name="spl_val" class="java.math.BigDecimal"/>
		<field name="pf_val" class="java.math.BigDecimal"/>
		<field name="freight_val" class="java.math.BigDecimal"/>
		<field name="dealer_val" class="java.math.BigDecimal"/>
		<field name="agent_com_val" class="java.math.BigDecimal"/>
		<field name="works_val" class="java.math.BigDecimal"/>
		<field name="prime_cost" class="java.math.BigDecimal"/>
	</subDataset>
	<subDataset name="dataset5">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer as book_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer as pf_val,

-- Tot val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer as total,

-- Les agent dis
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as les_agent_dis,

-- Nett sam
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as nett_sam

from ch_pump_offer pump

where header_id = $P{offer_id}

group by pump.insurance_in_ex]]>
		</queryString>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="total" class="java.lang.Integer"/>
		<field name="les_agent_dis" class="java.lang.Integer"/>
		<field name="nett_sam" class="java.lang.Integer"/>
	</subDataset>
	<subDataset name="dataset6">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select
-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer as book_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer as pf_val,

-- Tot val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer as total,

-- Les agent dis
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as les_agent_dis,

-- Nett sam
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as nett_sam

from ch_spare_offer pump

where header_id = $P{offer_id}

group by pump.insurance_in_ex]]>
		</queryString>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="total" class="java.lang.Integer"/>
		<field name="les_agent_dis" class="java.lang.Integer"/>
		<field name="nett_sam" class="java.lang.Integer"/>
	</subDataset>
	<subDataset name="dataset7">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select

-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) as book_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer pf_val,

-- Total val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer as total,

-- Les Agent val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer as les_agent_dis,

-- Nett sam
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer) -
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer) as nett_sam

from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.insurance_in_ex]]>
		</queryString>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="total" class="java.lang.Integer"/>
		<field name="les_agent_dis" class="java.lang.Integer"/>
		<field name="nett_sam" class="java.lang.Integer"/>
	</subDataset>
	<subDataset name="dataset8">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select sum(book_val) as book_val,sum(pf_val) as pf_val,sum(total) as total,
sum(les_agent_dis) as les_agent_dis,sum(nett_sam) as nett_sam from
((select
-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer as book_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer as pf_val,

-- Tot val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer as total,

-- Les agent dis
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as les_agent_dis,

-- Nett sam
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as nett_sam

from ch_pump_offer pump

where header_id = $P{offer_id}

group by pump.insurance_in_ex)

--------------Spare
union all

(select
-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer as book_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer as pf_val,

-- Tot val
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer as total,

-- Les agent dis
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as les_agent_dis,

-- Nett sam
((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer -
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)::integer-
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer)::integer as nett_sam

from ch_spare_offer pump

where header_id = $P{offer_id}

group by pump.insurance_in_ex)

---------------Access
union all

(select

-- Book val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) as book_val,

-- PF val
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer pf_val,

-- Total val
(sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer as total,

-- Les Agent val
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer as les_agent_dis,

-- Nett sam
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) +
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer) -
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer +
((((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer) -
(((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.special_discount ,0.00))))/100)::integer -
COALESCE((select ref_calc from (
select p_f_in_ex,
case when p_f_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.p_f_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.p_f ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.p_f_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer -
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer)::integer * avg((COALESCE(pump.agent_com ,0.00))))/100)::integer) as nett_sam

from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.insurance_in_ex
)

union all

(select

--Basic Book val
sum(((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer) as book_val,

-- PF val
sum(((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'exclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer) as pf_val,

-- Total
sum(((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer +
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'exclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer) as total,

-- Les agent dis
sum(((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer +
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer*
(COALESCE(pump.agent_com ,0)))/100)::integer) as les_agent_dis,

-- Nett sam
sum((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer +
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'exclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer) +
(((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer +
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer*
(COALESCE(pump.agent_com ,0)))/100)::integer)) as nett_sam

from ch_accessories_offer pump

left join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag != True)

-------------Freight
union all

(select sum(freight_val)::integer as freight_val,0,sum(freight_val)::integer as freight_val,0,sum(freight_val)::integer as freight_val
from(

-- Pump Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.insurance_in_ex

union

-- Spare Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.insurance_in_ex

union

-- Access Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val

union

-- Access False Freight val
select
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'exclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer as freight_val

from ch_accessories_offer pump

left join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and (access.is_pump_acc_flag != True or access.is_pump_acc_flag is null)

)as tot



)

) as ttaota]]>
		</queryString>
		<field name="book_val" class="java.math.BigDecimal"/>
		<field name="pf_val" class="java.math.BigDecimal"/>
		<field name="total" class="java.math.BigDecimal"/>
		<field name="les_agent_dis" class="java.math.BigDecimal"/>
		<field name="nett_sam" class="java.math.BigDecimal"/>
	</subDataset>
	<subDataset name="dataset9">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select

access.name as acc_name,

(COALESCE(pump.net_amount,0)) as net_amount,

-- Cust Dis val
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer as cust_dis_val,

-- Book val
((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer as book_val,

-- Spl val
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer as spl_val,

-- PF val
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer as pf_val,

-- Freight val
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer as freight_val,

-- Dealer val
((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer as dealer_val,

-- Less Dealer Val
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer*
(COALESCE(pump.agent_com ,0)))/100)::integer as agent_com_val,

-- Works Val
((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer*
(COALESCE(pump.dealer_discount ,0)))/100)::integer as works_val,

--Primecost val
(COALESCE(pump.prime_cost ,0)) as prime_cost,

-- Ratio val
ltrim(to_char((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer*
(COALESCE(pump.dealer_discount ,0)))/100)::integer)/
((COALESCE(pump.prime_cost::numeric ,0))),'999G999G99G999G99G99G990D99')) as ratio,

pump.tax as avg_basic_cpo,
(COALESCE(pump.customer_discount,0)) as avg_cust_dis,
(COALESCE(pump.special_discount,0)) as avg_spl_dis,
(COALESCE(pump.p_f,0)) as avg_pf_dis,
(COALESCE(pump.freight,0)) as avg_freight_dis,
(COALESCE(pump.dealer_discount,0)) as avg_deal_dis,
(COALESCE(pump.dealer_discount,0)) as avg_agent_dis

from ch_accessories_offer pump

left join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and (access.is_pump_acc_flag != True or access.is_pump_acc_flag is null)]]>
		</queryString>
		<field name="acc_name" class="java.lang.String"/>
		<field name="net_amount" class="java.math.BigDecimal"/>
		<field name="cust_dis_val" class="java.lang.Integer"/>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="spl_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="freight_val" class="java.lang.Integer"/>
		<field name="dealer_val" class="java.lang.Integer"/>
		<field name="agent_com_val" class="java.lang.Integer"/>
		<field name="works_val" class="java.lang.Integer"/>
		<field name="prime_cost" class="java.math.BigDecimal"/>
		<field name="ratio" class="java.lang.String"/>
		<field name="avg_basic_cpo" class="java.lang.Double"/>
		<field name="avg_cust_dis" class="java.lang.Double"/>
		<field name="avg_spl_dis" class="java.lang.Double"/>
		<field name="avg_pf_dis" class="java.lang.Double"/>
		<field name="avg_freight_dis" class="java.lang.Double"/>
		<field name="avg_deal_dis" class="java.lang.Double"/>
		<field name="avg_agent_dis" class="java.lang.Double"/>
	</subDataset>
	<subDataset name="dataset10">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select

access.name as acc_name,

--Basic Book val
((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer as book_val,

-- PF val
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'exclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer as pf_val,

-- Total
((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer +
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'exclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer as total,

-- Les agent dis
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer +
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer*
(COALESCE(pump.agent_com ,0)))/100)::integer as les_agent_dis,

-- Nett sam
(((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer +
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'exclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer) +
(((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer +
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*(COALESCE(pump.special_discount ,0.00)))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.p_f_in_ex = 'inclusive' then (COALESCE(pump.p_f ,0.00)) else 0.00 end))/100)::integer -
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer*
(COALESCE(pump.agent_com ,0)))/100)::integer) as nett_sam

from ch_accessories_offer pump

left join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and (access.is_pump_acc_flag != True or access.is_pump_acc_flag is null)]]>
		</queryString>
		<field name="acc_name" class="java.lang.String"/>
		<field name="book_val" class="java.lang.Integer"/>
		<field name="pf_val" class="java.lang.Integer"/>
		<field name="total" class="java.lang.Integer"/>
		<field name="les_agent_dis" class="java.lang.Integer"/>
		<field name="nett_sam" class="java.lang.Integer"/>
	</subDataset>
	<subDataset name="dataset11">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select sum(freight_val)::integer as freight_val
from(

-- Pump Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.insurance_in_ex

union

-- Spare Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.insurance_in_ex

union

-- Access Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'inclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val

union

-- Access False Freight val
select
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'inclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer as freight_val

from ch_accessories_offer pump

left join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag != True

)as tot]]>
		</queryString>
		<field name="freight_val" class="java.lang.Integer"/>
	</subDataset>
	<subDataset name="dataset12">
		<parameter name="offer_id" class="java.lang.Integer"/>
		<queryString>
			<![CDATA[select sum(freight_val)::integer as freight_val
from(

-- Pump Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val
from ch_pump_offer pump

where header_id = $P{offer_id}
group by pump.insurance_in_ex

union

-- Spare Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0))) -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val
from ch_spare_offer pump

where header_id = $P{offer_id}
group by pump.insurance_in_ex

union

-- Access Freight val
select
COALESCE((select ref_calc from (
select freight_in_ex,
case when freight_in_ex = 'exclusive' then calc else 0.00 end as ref_calc,
calc from (
select pump.freight_in_ex,((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer -
((sum((COALESCE((COALESCE(pump.net_amount,0)),0)))::integer*avg((COALESCE(pump.customer_discount ,0.00))))/100)::integer)
* avg((COALESCE(pump.freight ,0.00))))/100 as calc
from ch_accessories_offer pump

join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag = True
group by pump.freight_in_ex
) as sample
) as sam where ref_calc != 0),0)::integer freight_val

union

-- Access False Freight val
select
((((COALESCE(pump.net_amount,0))::integer -
(((COALESCE(pump.net_amount,0))::integer*(COALESCE(pump.customer_discount ,0.00)))/100)::integer)::integer*
(case when pump.freight_in_ex = 'exclusive' then (COALESCE(pump.freight ,0.00)) else 0.00 end))/100)::integer as freight_val

from ch_accessories_offer pump

left join kg_accessories_master access on(access.id=pump.access_id)

where header_id = $P{offer_id} and access.is_pump_acc_flag != True

)as tot]]>
		</queryString>
		<field name="freight_val" class="java.lang.Integer"/>
	</subDataset>
	<parameter name="offer_id" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[select off.name as off_no,
(case when wo.name is not null then wo.name else '-' end) as wo_no,
comp.name as company,

(CASE WHEN comppart.street is null
THEN ''
ELSE comppart.street
end ) as comp_street,
(CASE WHEN comppart.street2 is null
THEN ''
ELSE comppart.street2
end ) as comp_street2,
(CASE WHEN compcity.name is null
THEN ''
ELSE compcity.name
end ) as comp_city,
(CASE WHEN compstate.name is null
THEN ''
ELSE compstate.name
end ) as comp_state,
(CASE WHEN comppart.zip is null
THEN ''
ELSE comppart.zip
end ) as comp_zip,

(case when partcountry.name is not null then partner.name||' - '||partcountry.name else partner.name end) as customer,
(case when dealcountry.name is not null then dealer.name||' - '||dealcountry.name else dealer.name end) as dealer,
to_char(off.offer_date, 'dd/mm/yyyy') as offer_date,
'Date: '||to_char(current_date, 'dd/mm/yyyy') as current_date,
(CASE WHEN off.l_d_clause = '5_1' THEN '0.5 - 1.0% of total order value'
WHEN off.l_d_clause = '1_10' THEN '1 - 10% of total order value'
WHEN off.l_d_clause is null THEN ''
ELSE off.l_d_clause
end) as penality,
(CASE WHEN off.del_term = 'ex_works' THEN 'Ex-Works' WHEN off.del_term = 'fob' THEN 'FOB'
WHEN off.del_term = 'cfr' THEN 'CFR' WHEN off.del_term = 'cif' THEN 'CIF' WHEN off.del_term = 'cpt' THEN 'CPT'
ELSE off.del_term end) as del_term,
(CASE WHEN off.mode_of_dispatch = 'sea' THEN 'Sea Worthy' WHEN off.mode_of_dispatch = 'air' THEN 'Air Worthy'
ELSE off.mode_of_dispatch end) as mode_of_dispatch,
'C.P.O Ref No : '||(case when off.customer_po_no is not null then off.customer_po_no else '-' end)||' Dt: '||(case when off.cust_po_date is not null then to_char(off.cust_po_date, 'dd/mm/yyyy') else '-' end) as cpo_no

from kg_crm_offer off

left join res_partner partner on(partner.id=off.customer_id)
left join res_partner dealer on(dealer.id=off.dealer_id)
left join res_company comp on(comp.id=off.company_id)
left join res_partner comppart on(comppart.id=comp.partner_id)
left join res_city compcity on(compcity.id=comppart.city_id)
left join res_country_state compstate on(compstate.id=comppart.state_id)
left join res_country partcountry on(partcountry.id=partner.country_id)
left join res_country dealcountry on(dealcountry.id=dealer.country_id)
left join kg_work_order wo on(wo.offer_no=off.name)

where off.id = $P{offer_id} and off.segment = 'exp']]>
	</queryString>
	<field name="off_no" class="java.lang.String"/>
	<field name="wo_no" class="java.lang.String"/>
	<field name="company" class="java.lang.String"/>
	<field name="comp_street" class="java.lang.String"/>
	<field name="comp_street2" class="java.lang.String"/>
	<field name="comp_city" class="java.lang.String"/>
	<field name="comp_state" class="java.lang.String"/>
	<field name="comp_zip" class="java.lang.String"/>
	<field name="customer" class="java.lang.String"/>
	<field name="dealer" class="java.lang.String"/>
	<field name="offer_date" class="java.lang.String"/>
	<field name="current_date" class="java.lang.String"/>
	<field name="penality" class="java.lang.String"/>
	<field name="del_term" class="java.lang.String"/>
	<field name="mode_of_dispatch" class="java.lang.String"/>
	<field name="cpo_no" class="java.lang.String"/>
	<group name="Pump_detail">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset1">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="47" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" leftPadding="0" rightPadding="2">
									<topPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{net_amount}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="212" y="0" width="56" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{cust_dis_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="268" y="0" width="54" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" leftPadding="0" rightPadding="1">
									<topPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="347" y="0" width="36" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" leftPadding="0" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{spl_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="408" y="0" width="42" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="475" y="0" width="36" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="512" y="0" width="70" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" leftPadding="0" rightPadding="2">
									<topPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="612" y="0" width="52" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" leftPadding="0" rightPadding="2">
									<topPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{agent_com_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="664" y="0" width="56" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" leftPadding="0" rightPadding="2">
									<topPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{works_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="187" y="0" width="25" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_cust_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="322" y="0" width="25" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_spl_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="383" y="0" width="25" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_pf_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="450" y="0" width="25" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_freight_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="582" y="0" width="30" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_deal_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="720" y="0" width="63" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{prime_cost}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="783" y="0" width="42" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" rightPadding="0">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ratio}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="140" height="14" isRemoveLineWhenBlank="true"/>
								<box topPadding="2" leftPadding="0" rightPadding="2">
									<topPen lineWidth="0.5"/>
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="10"/>
								</textElement>
								<textFieldExpression><![CDATA["Pump"]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Spare_detail">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset2">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="10"/>
								</textElement>
								<textFieldExpression><![CDATA["Spare"]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="47" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{net_amount}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="187" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_cust_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="212" y="0" width="56" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{cust_dis_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="268" y="0" width="54" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="322" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_spl_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="347" y="0" width="36" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{spl_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="383" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_pf_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="408" y="0" width="42" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="450" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_freight_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="477" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="511" y="0" width="71" height="14"/>
								<box topPadding="2" rightPadding="2">
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="582" y="0" width="30" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_deal_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="664" y="0" width="56" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{works_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="720" y="0" width="63" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{prime_cost}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="783" y="0" width="42" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ratio}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="612" y="0" width="52" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{agent_com_val}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Access_detail">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset3">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField>
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="10"/>
								</textElement>
								<textFieldExpression><![CDATA["Accessories"]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="47" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{net_amount}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="187" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_cust_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="212" y="0" width="56" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{cust_dis_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="268" y="0" width="54" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="322" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_spl_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="347" y="0" width="36" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{spl_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="383" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_pf_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="408" y="0" width="42" height="14"/>
								<box topPadding="2" rightPadding="1">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="450" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_freight_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="477" y="0" width="34" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="512" y="0" width="70" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="582" y="0" width="30" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_agent_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="612" y="0" width="52" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{agent_com_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="664" y="0" width="56" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{works_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="720" y="0" width="63" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{prime_cost}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="783" y="0" width="42" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ratio}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Is_Accessories_details">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset9">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField>
								<reportElement x="140" y="0" width="47" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{net_amount}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center"/>
								<textFieldExpression><![CDATA[$F{acc_name}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="187" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_cust_dis}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="212" y="0" width="56" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{cust_dis_val}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="268" y="0" width="54" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="322" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_spl_dis}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="346" y="0" width="37" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{spl_val}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="383" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_pf_dis}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="408" y="0" width="42" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="450" y="0" width="25" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_freight_dis}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="475" y="0" width="36" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="511" y="0" width="71" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{dealer_val}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="582" y="0" width="30" height="14"/>
								<box topPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{avg_deal_dis}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="612" y="0" width="52" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{agent_com_val}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="664" y="0" width="56" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{works_val}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="720" y="0" width="63" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{prime_cost}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="783" y="0" width="42" height="14"/>
								<box topPadding="2" rightPadding="0">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{ratio}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Freight_Details">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset11">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField>
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center"/>
								<textFieldExpression><![CDATA["Freight"]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="47" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="268" y="0" width="54" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
				<textField isBlankWhenNull="true">
					<reportElement x="175" y="0" width="81" height="14"/>
					<box topPadding="2" rightPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right">
						<font size="8"/>
					</textElement>
					<textFieldExpression><![CDATA["0"]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement x="310" y="0" width="503" height="14"/>
					<box topPadding="2" rightPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right">
						<font size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[" "]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="Supervision_detail">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="15">
				<componentElement>
					<reportElement x="48" y="0" width="765" height="15"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset4">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="15" width="765">
							<textField isBlankWhenNull="true">
								<reportElement x="80" y="0" width="47" height="15"/>
								<box topPadding="2" rightPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{net_amount}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="127" y="0" width="81" height="15"/>
								<box topPadding="2" rightPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{cust_dis_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="208" y="0" width="54" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="262" y="0" width="61" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{spl_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="323" y="0" width="67" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="390" y="0" width="61" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="451" y="0" width="71" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{dealer_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="522" y="0" width="82" height="15"/>
								<box topPadding="2" rightPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{agent_com_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="604" y="0" width="56" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{works_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="660" y="0" width="63" height="15"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{prime_cost}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
				<textField>
					<reportElement x="-12" y="0" width="140" height="15"/>
					<box topPadding="2">
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="771" y="0" width="42" height="15"/>
					<box>
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[""]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="Child_detail">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="48">
				<textField>
					<reportElement x="-12" y="17" width="140" height="17"/>
					<box topPadding="2" leftPadding="2">
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement/>
					<textFieldExpression><![CDATA["Description"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="128" y="17" width="109" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center">
						<font size="10"/>
					</textElement>
					<textFieldExpression><![CDATA["Basic Value"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="237" y="17" width="73" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["P&F"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="310" y="17" width="189" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["Total"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="-12" y="0" width="825" height="17"/>
					<box topPadding="2">
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center">
						<font isBold="true" isUnderline="true"/>
					</textElement>
					<textFieldExpression><![CDATA["SAM Invoice Details"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="499" y="17" width="224" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["Less (Agent Discount+ Service Tax)"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="723" y="17" width="90" height="17"/>
					<box topPadding="2">
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center"/>
					<textFieldExpression><![CDATA["Nett To SAM"]]></textFieldExpression>
				</textField>
				<componentElement>
					<reportElement x="-12" y="34" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset5">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="109" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="249" y="0" width="73" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="322" y="0" width="189" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="511" y="0" width="224" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_agent_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="735" y="0" width="90" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{nett_sam}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2" rightPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="10"/>
								</textElement>
								<textFieldExpression><![CDATA["Pump"]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Child_spare">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset6">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="10"/>
								</textElement>
								<textFieldExpression><![CDATA["Spare"]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="109" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="249" y="0" width="73" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="322" y="0" width="189" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="511" y="0" width="224" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_agent_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="735" y="0" width="90" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{nett_sam}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Child_access">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset7">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center">
									<font size="10"/>
								</textElement>
								<textFieldExpression><![CDATA["Accessories"]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="109" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="249" y="0" width="73" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="322" y="0" width="189" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="511" y="0" width="224" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_agent_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="735" y="0" width="90" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{nett_sam}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Child_Is_Accessories">
		<groupExpression><![CDATA[$P{offer_id}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset10">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField>
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center"/>
								<textFieldExpression><![CDATA[$F{acc_name}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="140" y="0" width="109" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="249" y="0" width="73" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="322" y="0" width="189" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="511" y="0" width="224" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_agent_dis}]]></textFieldExpression>
							</textField>
							<textField>
								<reportElement x="735" y="0" width="90" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{nett_sam}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Child_Freight">
		<groupExpression><![CDATA[$F{off_no}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="-12" y="0" width="825" height="14" isRemoveLineWhenBlank="true"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset12">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="825">
							<textField>
								<reportElement x="0" y="0" width="140" height="14"/>
								<box topPadding="2">
									<leftPen lineWidth="0.5"/>
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center"/>
								<textFieldExpression><![CDATA["Freight"]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="140" y="0" width="109" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="249" y="0" width="73" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA["--"]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="322" y="0" width="189" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="511" y="0" width="224" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA["0"]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="735" y="0" width="90" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{freight_val}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="Child_Supervision">
		<groupExpression><![CDATA[$F{off_no}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<componentElement>
					<reportElement x="128" y="0" width="685" height="14"/>
					<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
						<datasetRun subDataset="dataset8">
							<datasetParameter name="offer_id">
								<datasetParameterExpression><![CDATA[$P{offer_id}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:listContents height="14" width="685">
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="109" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{book_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="109" y="0" width="73" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{pf_val}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="182" y="0" width="189" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="371" y="0" width="224" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{les_agent_dis}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="595" y="0" width="90" height="14"/>
								<box topPadding="2" rightPadding="2">
									<bottomPen lineWidth="0.5"/>
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Right">
									<font size="8" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{nett_sam}]]></textFieldExpression>
							</textField>
						</jr:listContents>
					</jr:list>
				</componentElement>
				<textField>
					<reportElement x="-12" y="0" width="140" height="14"/>
					<box topPadding="2">
						<leftPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
						<rightPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL"]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="106" splitType="Stretch">
			<textField>
				<reportElement x="168" y="0" width="448" height="24"/>
				<box topPadding="4"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{company}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="-12" y="40" width="825" height="16"/>
				<box topPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["COMMERCIAL DETAILS - EXPORT"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="188" y="56" width="68" height="25"/>
				<box topPadding="4" leftPadding="2">
					<leftPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Customer : "]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="256" y="56" width="360" height="25"/>
				<box topPadding="4">
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{customer}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="48" y="24" width="708" height="14"/>
				<textElement textAlignment="Center"/>
				<textFieldExpression><![CDATA[$F{comp_street}+$F{comp_street2}+$F{comp_city}+$F{comp_state}+'-'+$F{comp_zip}]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="-12" y="0" width="60" height="38"/>
				<imageExpression><![CDATA["/OpenERP/Sam_Turbo/openerp-foundry/openerp-server/openerp/addons/kg_crm_offer/img/sam.png"]]></imageExpression>
			</image>
			<textField>
				<reportElement x="-12" y="56" width="103" height="25"/>
				<box topPadding="5" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Delivery Terms     : "]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="-12" y="81" width="103" height="25"/>
				<box topPadding="5" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Mode of Dispatch : "]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="91" y="56" width="97" height="25"/>
				<box topPadding="5" leftPadding="2">
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font size="9" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{del_term}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="91" y="81" width="97" height="25"/>
				<box topPadding="5" leftPadding="2">
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font size="9" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{mode_of_dispatch}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="188" y="81" width="68" height="25"/>
				<box topPadding="4" leftPadding="2">
					<leftPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Agent : "]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="256" y="81" width="360" height="25"/>
				<box topPadding="4">
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dealer}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="616" y="74" width="197" height="16"/>
				<box topPadding="2" leftPadding="2">
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{current_date}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="616" y="90" width="197" height="16"/>
				<box topPadding="2" leftPadding="2">
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cpo_no}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="616" y="56" width="54" height="18"/>
				<box topPadding="2" leftPadding="1">
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["WO No.:"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" x="671" y="56" width="142" height="18" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="1">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA[$F{wo_no}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<columnHeader>
		<band height="16" splitType="Stretch">
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="-12" y="0" width="140" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Description"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="128" y="0" width="47" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["CPO value"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="310" y="0" width="61" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Less Discount (S.D)"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="256" y="0" width="54" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Book Value"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="175" y="0" width="81" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Less Cust.Discount"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="438" y="0" width="61" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Freight (Topay / Paid)"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="371" y="0" width="67" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["P&F"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="771" y="0" width="42" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Ratio"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="652" y="0" width="56" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Works Value"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="708" y="0" width="63" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Prime Cost"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="570" y="0" width="82" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Agent Commission"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="499" y="0" width="71" height="16" isPrintWhenDetailOverflows="true"/>
				<box topPadding="2" leftPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression><![CDATA["Value considered for Agent Discount"]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<pageFooter>
		<band height="13">
			<textField evaluationTime="Report">
				<reportElement x="370" y="0" width="129" height="13"/>
				<box topPadding="2" leftPadding="0">
					<topPen lineWidth="0.0"/>
				</box>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="290" y="0" width="80" height="13"/>
				<box topPadding="2" leftPadding="0">
					<topPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<lastPageFooter>
		<band height="39">
			<textField>
				<reportElement x="59" y="25" width="132" height="14"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["SR. ENGG"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="333" y="25" width="132" height="14"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["V.P"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="600" y="25" width="132" height="14"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["MD"]]></textFieldExpression>
			</textField>
		</band>
	</lastPageFooter>
	<noData>
		<band height="50">
			<textField>
				<reportElement x="333" y="30" width="128" height="20"/>
				<textElement textAlignment="Center">
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["No Data Found"]]></textFieldExpression>
			</textField>
		</band>
	</noData>
</jasperReport>
